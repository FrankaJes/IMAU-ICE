================================================================
=============== How to run IMAU_ICE on Cartesius ===============
================================================================
=================== Tijn Berends, July 2021 ====================
================================================================



1. Make sure you have the required scripts in your IMAU-ICE folder:

 - compile_all_Cartesius.csh
 - compile_clean_Cartesius.csh
 - run_IMAU_ICE_Cartesius.csh
 - submit_IMAU_ICE_Cartesis.sh



2. Change the "include" option in your Makefile to the Cartesius version:

   #include Makefile_include_local.txt
   #include Makefile_include_Gemini.txt
   include Makefile_include_Cartesius.txt


3. Run "./compile_clean_Cartesius.csh" to compile the model.



4. Make sure you have uploaded all the required input files, and that
   the paths to these in your config file are correct.
 
   

5. Make sure to set the following two config options in your config file:

   create_procedural_output_dir_config = .FALSE.
   fixed_output_dir_config             = 'results'
  
  
  
6. Set the number of cores and the requested walltime in the run script
   "run_IMAU_ICE_Cartesius.csh". Look for these two lines:
   
     #SBATCH -t 00:30:00
     set number_of_cores = 24
     
   These set the walltime to 30 minutes and the number of cores to 24.
   Note: the line "#SBATCH -N 1" sets the number of nodes to 1. Don't change this;
         currently, IMAU-ICE cannot run on more than 1 node.



7. Set the path to your config file and the name tag of your run in
   the submit script "submit_IMAU_ICE_Cartesius.sh". Look for this line:
   
     sbatch run_IMAU_ICE_Cartesius.csh src_dev/config-files/config_test test_run
     
   This runs your model with the config file "config_test" (in the config file
   folder of the src_dev model version), and appends the name tag "test_run" to
   the results folder.



8. Run "./submit_IMAU_ICE_Cartesius.sh" to submit your simulation to SLURM.
   


9. If all went well, once the run is finished the model output should
   be in "results_IMAU_ICE_Cartesius_test_run" in your IMAU-ICE directory.



P.S. Some useful commands:

  squeue -u YOUR_USERNAME (e.g. squeue -u berends) to inspect your job queue
  
  If I have a job running, this will give output looking like this:
  
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          10569746    normal AA_run_I  berends  R       0:16      1 tcn1043
  
  scancel JOBID to cancel a job (e.g. scancel 10569746)